#%% object3d classes

class object3d:
    obj_inst = []
    def __init__(self, name, coordinate2d, coordinate3d, material):
        self.name = name
        self.coordinate2d = coordinate2d
        self.coordinate3d = coordinate3d
        self.material = material
        self.__class__.obj_inst.append(self)

class magnet(object3d):
    mag_inst = []
    def __init__(self, name, coordinate2d, coordinate3d, material, coercitivity, mag_dir_x, mag_dir_y):
        super().__init__(name, coordinate2d, coordinate3d, material)
        self.coercitivity = coercitivity
        self.mag_dir_x = mag_dir_x
        self.mag_dir_y = mag_dir_y
        self.__class__.mag_inst.append(self)

class conductor(object3d):
    cond_inst =  []
    def __init__(self, name, coordinate2d, coordinate3d, material, phase_name, conductor_number, positive_current):
        super().__init__(name, coordinate2d, coordinate3d, material)
        self.phase_name = phase_name
        self.conductor_number = conductor_number
        self.positive_current = positive_current
        self.__class__.cond_inst.append(self)
        
magnet_1 = magnet(
    name="magnet_1",
    coordinate2d = [
        [(0.005, 0.0, 0), (0.0035355339059327372, 0.0035355339059327372, 0), (0, 0.005, 0)],
        [(0, -0.005, 0), (0.0035355339059327385, -0.0035355339059327372, 0), (0.005, 0.0, 0)],
        [(0, 0.005, 0), (0, 0.011, 0)],
        [(0, -0.005, 0), (0, -0.011, 0)],
        [(0.011, 0.0, 0), (0.007778174593052023, 0.007778174593052021, 0), (0, 0.011, 0)],
        [(0, -0.011, 0), (0.007778174593052024, -0.007778174593052021, 0), (0.011, 0.0, 0)],
    ],
    coordinate3d = [(0, 0, 0.0), (0, 0, 0.04)],
    material = 'magnet_n35eh',
    coercitivity = -800355.9979335237,
    mag_dir_x = 1,
    mag_dir_y = 0,
)

magnet_2 = magnet(
    name="magnet_2",
    coordinate2d = [
        [(-0.005, 0, 0), (-0.0035355339059327385, -0.0035355339059327377, 0), (0, -0.005, 0)],
        [(0, 0.005, 0), (-0.003535533905932737, 0.0035355339059327377, 0), (-0.005, 0, 0)],
        [(0, -0.005, 0), (0, -0.011, 0)],
        [(0, 0.005, 0), (0, 0.011, 0)],
        [(-0.011, 0, 0), (-0.007778174593052024, -0.007778174593052021, 0), (0, -0.011, 0)],
        [(0, 0.011, 0), (-0.00777817459305202, 0.007778174593052023, 0), (-0.011, 0, 0)],
    ],
    coordinate3d = [[0, 0, 0.0], [0, 0, 0.04]],
    material = 'magnet_n35eh',
    coercitivity = -800355.9979335237,
    mag_dir_x = 1,
    mag_dir_y = 0,
)

shaft = object3d(
    name='shaft',
    coordinate2d=[
        [(0.005, 0.0, 0), (0.003535533905932738, 0.0035355339059327372, 0), (0, 0.005, 0)],
        [(0, -0.005, 0), (0.0035355339059327385, -0.0035355339059327372, 0), (0.005, 0.0, 0)],
        [(-0.005, 0, 0), (-0.0035355339059327385, -0.0035355339059327377, 0), (0, -0.005, 0)],
        [(0, 0.005, 0), (-0.003535533905932737, 0.0035355339059327377, 0), (-0.005, 0, 0)],
    ],
    coordinate3d = [[0, 0, -0.027], [0, 0, 0.067]],
    material = 'steel_shaft',
)

coil_1_1 = conductor(
    name='coil_1_1',
    coordinate2d=[
        [(0.012358964678580466, 0.0031334473146361315, 0), (0.016376745241473322, 0.005418921968056081, 0)],
        [(0.016376745241473322, 0.005418921968056081, 0), (0.01725000000000018, 0, 0), (0.016376745241473322, -0.005418921968056081, 0)],
        [(0.016376745241473322, -0.005418921968056081, 0), (0.012358964678580466, -0.0031334473146361315, 0)],
        [(0.012358964678580466, -0.0031334473146361315, 0), (0.012750000000000494, 0, 0), (0.012358964678580466, 0.0031334473146361315, 0)],
    ],
    coordinate3d = [[0, 0, -0.027], [0, 0, 0.067]],
    material = 'copper_RoundWireConductor',
    phase_name='phase_A',
    conductor_number=32,
    positive_current=False
)

coil_3_2 = conductor(
  name='coil_3_2',
  coordinate2d=[ 
        [(0.003465837363395214, 0.01226990103344333, 0), (0.0034954485352745313, 0.01689213839444986, 0)],
        [(0.0034954485352745313, 0.01689213839444986, 0), (0.008624999999999106, 0.01493893821528229, 0), (0.012881296706198796, 0.011473216426393778, 0)],
        [(0.012881296706198796, 0.011473216426393778, 0), (0.008893127315185257, 0.009136453718807197, 0)],
        [(0.008893127315185257, 0.009136453718807197, 0), (0.006375000000003694, 0.011041823898250031, 0), (0.003465837363395214, 0.01226990103344333, 0)],
  ],
    coordinate3d = [[0, 0, -0.027], [0, 0, 0.067]],
    material = 'copper_RoundWireConductor',
    phase_name='phase_C',
    conductor_number=32,
    positive_current=True
)

coil_2_1 = conductor(
  name='coil_2_1',
  coordinate2d=[ 
    [(-0.00889312731518525, 0.009136453718807202, 0), (-0.012881296706198793, 0.011473216426393781, 0)],
    [(-0.012881296706198793, 0.011473216426393781, 0), (-0.008625000000001071, 0.014938938215281156, 0), (-0.003495448535274525, 0.01689213839444986, 0)],
    [(-0.003495448535274525, 0.01689213839444986, 0), (-0.0034658373633952096, 0.012269901033443331, 0)],
    [(-0.0034658373633952096, 0.012269901033443331, 0), (-0.0063749999999968025, 0.011041823898254009, 0), (-0.00889312731518525, 0.009136453718807202, 0)],
  ],
    coordinate3d = [[0, 0, -0.027], [0, 0, 0.067]],
    material = 'copper_RoundWireConductor',
    phase_name='phase_B',
    conductor_number=32,
    positive_current=False
)

coil_1_2 = conductor(
  name='coil_1_2',
  coordinate2d=[
    [(-0.012358964678580468, -0.0031334473146361276, 0), (-0.016376745241473322, -0.005418921968056079, 0)],
    [(-0.016376745241473322, -0.005418921968056079, 0), (-0.01725000000000018, 0, 0), (-0.016376745241473322, 0.0054189219680560825, 0)],
    [(-0.016376745241473322, 0.0054189219680560825, 0), (-0.012358964678580468, 0.0031334473146361307, 0)],
    [(-0.012358964678580468, 0.0031334473146361307, 0), (-0.012750000000000495, 0, 0), (-0.012358964678580468, -0.0031334473146361276, 0)],
  ],
    coordinate3d = [[0, 0, -0.027], [0, 0, 0.067]],
    material = 'copper_RoundWireConductor',
    phase_name='phase_A',
    conductor_number=32,
    positive_current=True
)

coil_3_1 = conductor(
  name='coil_3_1',
  coordinate2d=[   
    [(-0.0034658373633952152, -0.01226990103344333, 0), (-0.0034954485352745447, -0.016892138394449856, 0)],
    [(-0.0034954485352745447, -0.016892138394449856, 0), (-0.008624999999999113, -0.014938938215282287, 0), (-0.0128812967061988, -0.011473216426393772, 0)],
    [(-0.0128812967061988, -0.011473216426393772, 0), (-0.008893127315185257, -0.009136453718807197, 0)],
    [(-0.008893127315185257, -0.009136453718807197, 0), (-0.006375000000003693, -0.011041823898250031, 0), (-0.0034658373633952152, -0.01226990103344333, 0)],
  ],
    coordinate3d = [[0, 0, -0.027], [0, 0, 0.067]],
    material = 'copper_RoundWireConductor',
    phase_name='phase_C',
    conductor_number=32,
    positive_current=False
)

coil_2_2 = conductor(
  name='coil_2_2',
  coordinate2d=[   
    [(0.008893127315185257, -0.009136453718807195, 0), (0.012881296706198789, -0.011473216426393783, 0)],
    [(0.012881296706198789, -0.011473216426393783, 0), (0.00862500000000108, -0.014938938215281155, 0), (0.003495448535274538, -0.01689213839444986, 0)],
    [(0.003495448535274538, -0.01689213839444986, 0), (0.003465837363395211, -0.012269901033443331, 0)],
    [(0.003465837363395211, -0.012269901033443331, 0), (0.006374999999996807, -0.011041823898254009, 0), (0.008893127315185257, -0.009136453718807195, 0)],
  ],
    coordinate3d = [[0, 0, -0.027], [0, 0, 0.067]],
    material = 'copper_RoundWireConductor',
    phase_name='phase_B',
    conductor_number=32,
    positive_current=True
)

stator = object3d(
    name='stator',
    coordinate2d=[ 
        [(0.024, 0.0, 0), (0.016970562748477143, 0.01697056274847714, 0), (0, 0.024, 0)],
        [(0, 0.024, 0), (-0.01697056274847714, 0.016970562748477143, 0), (-0.024, 0, 0)],
        [(-0.024, 0, 0), (-0.01697056274847715, -0.016970562748477143, 0), (0, -0.024, 0)],
        [(0, -0.024, 0), (0.016970562748477143, -0.01697056274847714, 0), (0.024, 0.0, 0)],
    ],
    coordinate3d = [[0, 0, 0], [0, 0, 0.04]],
    material = 'steel_stator_M400-50A',
)

stator_int = object3d(
    name='stator_int',
    coordinate2d=[
        [(0.0175, 0.0, 0), (0.017253655590848863, 0.0029259816732790183, 0), (0.01652155785687372, 0.0057695862920987785, 0)],
        [(0.01652155785687372, -0.0057695862920987785, 0), (0.017253655590849435, -0.0029259816732756325, 0), (0.0175, 0.0, 0)],
        [(0.012074072828613355, 0.0032352380637815092, 0), (0.010825321828217233, 0.006250002471586696, 0), (0.008838834764831846, 0.008838834764831844, 0)],
        [(0.012074072828613355, 0.0032352380637815092, 0), (0.01652155785687372, 0.0057695862920987785, 0)],
        [(0.012074072828613355, -0.0032352380637815092, 0), (0.01652155785687372, -0.0057695862920987785, 0)],
        [(0.008750000000000003, 0.015155444566227676, 0), (0.006092853335357106, 0.016405094886462034, 0), (0.0032641706301528546, 0.01719288196019642, 0)],
        [(0.013257387226720868, 0.01142329566809764, 0), (0.011160802255489117, 0.013479113213185205, 0), (0.008750000000000003, 0.015155444566227676, 0)],
        [(0.0032352380637815123, 0.012074072828613353, 0), (0, 0.012500004943171675, 0), (-0.003235238063781508, 0.012074072828613355, 0)],
        [(0.0032352380637815123, 0.012074072828613353, 0), (0.0032641706301528546, 0.01719288196019642, 0)],
        [(0.008838834764831846, 0.008838834764831844, 0), (0.013257387226720868, 0.01142329566809764, 0)],
        [(-0.008749999999999997, 0.015155444566227678, 0), (-0.011160802255491752, 0.01347911321318302, 0), (-0.013257387226720863, 0.011423295668097645, 0)],
        [(-0.0032641706301528525, 0.01719288196019642, 0), (-0.0060928533353603225, 0.016405094886460837, 0), (-0.008749999999999997, 0.015155444566227678, 0)],
        [(-0.008838834764831844, 0.008838834764831846, 0), (-0.010825321828218224, 0.006250002471584981, 0), (-0.012074072828613353, 0.0032352380637815127, 0)],
        [(-0.008838834764831844, 0.008838834764831846, 0), (-0.013257387226720863, 0.011423295668097645, 0)],
        [(-0.003235238063781508, 0.012074072828613355, 0), (-0.0032641706301528525, 0.01719288196019642, 0)],
        [(-0.0175, 0, 0), (-0.017253655590848866, -0.0029259816732790157, 0), (-0.016521557856873724, -0.005769586292098774, 0)],
        [(-0.01652155785687372, 0.0057695862920987785, 0), (-0.017253655590849435, 0.0029259816732756373, 0), (-0.0175, 0, 0)],
        [(-0.012074072828613355, -0.00323523806378151, 0), (-0.010825321828217235, -0.006250002471586695, 0), (-0.00883883476483185, -0.008838834764831839, 0)],
        [(-0.012074072828613355, -0.00323523806378151, 0), (-0.016521557856873724, -0.005769586292098774, 0)],
        [(-0.012074072828613353, 0.0032352380637815127, 0), (-0.01652155785687372, 0.0057695862920987785, 0)],
        [(-0.008750000000000008, -0.015155444566227673, 0), (-0.0060928533353571, -0.016405094886462034, 0), (-0.003264170630152857, -0.01719288196019642, 0)],
        [(-0.01325738722672087, -0.011423295668097636, 0), (-0.011160802255489119, -0.013479113213185203, 0), (-0.008750000000000008, -0.015155444566227673, 0)],
        [(-0.0032352380637815192, -0.012074072828613351, 0), (0, -0.012500004943171675, 0), (0.0032352380637815144, -0.012074072828613353, 0)],
        [(-0.0032352380637815192, -0.012074072828613351, 0), (-0.003264170630152857, -0.01719288196019642, 0)],
        [(-0.00883883476483185, -0.008838834764831839, 0), (-0.01325738722672087, -0.011423295668097636, 0)],
        [(0.008750000000000003, -0.015155444566227676, 0), (0.011160802255491771, -0.013479113213183007, 0), (0.013257387226720874, -0.011423295668097636, 0)],
        [(0.0032641706301528503, -0.01719288196019642, 0), (0.0060928533353603286, -0.016405094886460834, 0), (0.008750000000000003, -0.015155444566227676, 0)],
        [(0.008838834764831842, -0.008838834764831846, 0), (0.010825321828218224, -0.00625000247158498, 0), (0.012074072828613355, -0.0032352380637815092, 0)],
        [(0.008838834764831842, -0.008838834764831846, 0), (0.013257387226720874, -0.011423295668097636, 0)],
        [(0.0032352380637815144, -0.012074072828613353, 0), (0.0032641706301528503, -0.01719288196019642, 0)],
    ],
    coordinate3d = None,
    material = None,
)

moving_out = object3d(
    name='moving_out',
    coordinate2d=[
        [(0.0119975, 0, 0), (0.008483513607285604, 0.008483513607285604, 0), (0, 0.0119975, 0)],
        [(0, 0.0119975, 0), (-0.008483513607285604, 0.008483513607285604, 0), (-0.0119975, 0, 0)],
        [(-0.0119975, 0, 0), (-0.008483513607285605, -0.008483513607285604, 0), (0, -0.0119975, 0)],
        [(0, -0.0119975, 0), (0.008483513607285604, -0.008483513607285604, 0), (0.0119975, 0, 0)],
    ],
    coordinate3d = [[0, 0, -0.027], [0, 0, 0.067]],
    material = None,
)

moving_in = object3d(
    name='moving_in',
    coordinate2d=[
        [(0.0115025, 0, 0), (0.008133495750598263, 0.008133495750598263, 0), (0, 0.0115025, 0)],
        [(0, 0.0115025, 0), (-0.008133495750598263, 0.008133495750598263, 0), (-0.0115025, 0, 0)],
        [(-0.0115025, 0, 0), (-0.008133495750598265, -0.008133495750598263, 0), (0, -0.0115025, 0)],
        [(0, -0.0115025, 0), (0.008133495750598263, -0.008133495750598263, 0), (0.0115025, 0, 0)],
    ],
    coordinate3d = [[0, 0, -0.027], [0, 0, 0.067]],
    material = None,
)

#%% material classes

class material:
  mat_inst=[]
  def __init__(self, name, density, conductivity, permeability, nLinear_permeability, coreloss):
    self.name = name
    self.density = density
    self.conductivity = conductivity
    self.permeability = permeability
    self.nLinear_permeability = nLinear_permeability
    self.coreloss = coreloss
    self.__class__.mat_inst.append(self)

copper_RoundWireConductor = material(
    name = 'copper_RoundWireConductor',
    density = '8900',
    conductivity = '40948275.862',
    permeability='1',
    nLinear_permeability=None,
    coreloss = None,
)

steel_shaft = material(
    name = 'steel_shaft',
    density = '7700',
    conductivity = '0',
    permeability=None,
    nLinear_permeability = [[0.0, 0.0], [223.0, 0.31], [415.0, 0.57], [618.0, 0.79], [830.0, 0.97], [1040.0, 1.1], [1320.0, 1.2], [1800.0, 1.3], [2600.0, 1.4], [3800.0, 1.5], [5600.0, 1.6], [7700.0, 1.67], [10700.0, 1.74], [14000.0, 1.8], [18500.0, 1.86], [29000.0, 1.94], [48000.0, 2.04], [55000.0, 2.07], [68000.0, 2.1], [147577.47154594774, 2.2]],
    coreloss = None,
)

steel_stator = material(
    name = 'steel_stator_M400-50A',
    density = '7700',
    conductivity = '0',
    permeability=None,
    nLinear_permeability = [[0.0, 0.0], [223.0, 0.31], [415.0, 0.57], [618.0, 0.79], [830.0, 0.97], [1040.0, 1.1], [1320.0, 1.2], [1800.0, 1.3], [2600.0, 1.4], [3800.0, 1.5], [5600.0, 1.6], [7700.0, 1.67], [10700.0, 1.74], [14000.0, 1.8], [18500.0, 1.86], [29000.0, 1.94], [48000.0, 2.04], [55000.0, 2.07], [68000.0, 2.1], [147577.47154594774, 2.2]],
    coreloss = {'kh': 0.023992781365736068, 'kc': 0.0001194246951384754, 'ke': 0.0006911662417746252, 'kdc': 0.0, 'cut_depth': "0.001meter"}
)

magnet_mat = material(
    name = 'magnet_n35eh',
    density = '7400',
    conductivity = '0',
    permeability='1.07',
    nLinear_permeability = None,
    coreloss = None,
)

#%% winding classes

class phase_winding:
  ph_inst = []
  def __init__(self, name, current):
    self.name = name
    self.current = current
    self.__class__.ph_inst.append(self)

winding_A = phase_winding(
    name = 'phase_A',
    current="14.142*cos(2*pi*334.0*time+0deg)"
)

winding_B = phase_winding(
    name = 'phase_B',
    current="14.142*cos(2*pi*334.0*time-120deg)"
)

winding_C = phase_winding(
    name = 'phase_C',
    current="14.142*cos(1.0*2*pi*334.0*time-240deg)"
)